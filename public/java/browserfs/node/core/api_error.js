"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
(function (ErrorCode) {
    ErrorCode[ErrorCode["EPERM"] = 0] = "EPERM";
    ErrorCode[ErrorCode["ENOENT"] = 1] = "ENOENT";
    ErrorCode[ErrorCode["EIO"] = 2] = "EIO";
    ErrorCode[ErrorCode["EBADF"] = 3] = "EBADF";
    ErrorCode[ErrorCode["EACCES"] = 4] = "EACCES";
    ErrorCode[ErrorCode["EBUSY"] = 5] = "EBUSY";
    ErrorCode[ErrorCode["EEXIST"] = 6] = "EEXIST";
    ErrorCode[ErrorCode["ENOTDIR"] = 7] = "ENOTDIR";
    ErrorCode[ErrorCode["EISDIR"] = 8] = "EISDIR";
    ErrorCode[ErrorCode["EINVAL"] = 9] = "EINVAL";
    ErrorCode[ErrorCode["EFBIG"] = 10] = "EFBIG";
    ErrorCode[ErrorCode["ENOSPC"] = 11] = "ENOSPC";
    ErrorCode[ErrorCode["EROFS"] = 12] = "EROFS";
    ErrorCode[ErrorCode["ENOTEMPTY"] = 13] = "ENOTEMPTY";
    ErrorCode[ErrorCode["ENOTSUP"] = 14] = "ENOTSUP";
})(exports.ErrorCode || (exports.ErrorCode = {}));
var ErrorCode = exports.ErrorCode;
var ErrorStrings = {};
ErrorStrings[ErrorCode.EPERM] = 'Operation not permitted.';
ErrorStrings[ErrorCode.ENOENT] = 'No such file or directory.';
ErrorStrings[ErrorCode.EIO] = 'Input/output error.';
ErrorStrings[ErrorCode.EBADF] = 'Bad file descriptor.';
ErrorStrings[ErrorCode.EACCES] = 'Permission denied.';
ErrorStrings[ErrorCode.EBUSY] = 'Resource busy or locked.';
ErrorStrings[ErrorCode.EEXIST] = 'File exists.';
ErrorStrings[ErrorCode.ENOTDIR] = 'File is not a directory.';
ErrorStrings[ErrorCode.EISDIR] = 'File is a directory.';
ErrorStrings[ErrorCode.EINVAL] = 'Invalid argument.';
ErrorStrings[ErrorCode.EFBIG] = 'File is too big.';
ErrorStrings[ErrorCode.ENOSPC] = 'No space left on disk.';
ErrorStrings[ErrorCode.EROFS] = 'Cannot modify a read-only file system.';
ErrorStrings[ErrorCode.ENOTEMPTY] = 'Directory is not empty.';
ErrorStrings[ErrorCode.ENOTSUP] = 'Operation is not supported.';
var ApiError = (function (_super) {
    __extends(ApiError, _super);
    function ApiError(type, message, path) {
        if (message === void 0) { message = ErrorStrings[type]; }
        if (path === void 0) { path = null; }
        _super.call(this, message);
        this.syscall = "";
        this.errno = type;
        this.code = ErrorCode[type];
        this.path = path;
        this.stack = (new Error()).stack;
        this.message = "Error: " + this.code + ": " + message + (this.path ? ", '" + this.path + "'" : '');
    }
    ApiError.prototype.toString = function () {
        return this.message;
    };
    ApiError.prototype.toJSON = function () {
        return {
            errno: this.errno,
            code: this.code,
            path: this.path,
            stack: this.stack,
            message: this.message
        };
    };
    ApiError.fromJSON = function (json) {
        var err = new ApiError(0);
        err.errno = json.errno;
        err.code = json.code;
        err.path = json.path;
        err.stack = json.stack;
        err.message = json.message;
        return err;
    };
    ApiError.prototype.writeToBuffer = function (buffer, i) {
        if (buffer === void 0) { buffer = new Buffer(this.bufferSize()); }
        if (i === void 0) { i = 0; }
        var bytesWritten = buffer.write(JSON.stringify(this.toJSON()), i + 4);
        buffer.writeUInt32LE(bytesWritten, i);
        return buffer;
    };
    ApiError.fromBuffer = function (buffer, i) {
        if (i === void 0) { i = 0; }
        return ApiError.fromJSON(JSON.parse(buffer.toString('utf8', i + 4, i + 4 + buffer.readUInt32LE(i))));
    };
    ApiError.prototype.bufferSize = function () {
        return 4 + Buffer.byteLength(JSON.stringify(this.toJSON()));
    };
    ApiError.FileError = function (code, p) {
        return new ApiError(code, ErrorStrings[code], p);
    };
    ApiError.ENOENT = function (path) {
        return this.FileError(ErrorCode.ENOENT, path);
    };
    ApiError.EEXIST = function (path) {
        return this.FileError(ErrorCode.EEXIST, path);
    };
    ApiError.EISDIR = function (path) {
        return this.FileError(ErrorCode.EISDIR, path);
    };
    ApiError.ENOTDIR = function (path) {
        return this.FileError(ErrorCode.ENOTDIR, path);
    };
    ApiError.EPERM = function (path) {
        return this.FileError(ErrorCode.EPERM, path);
    };
    ApiError.ENOTEMPTY = function (path) {
        return this.FileError(ErrorCode.ENOTEMPTY, path);
    };
    return ApiError;
}(Error));
exports.ApiError = ApiError;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpX2Vycm9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvcmUvYXBpX2Vycm9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUtBLFdBQVksU0FBUztJQUNuQiwyQ0FBSyxDQUFBO0lBQUUsNkNBQU0sQ0FBQTtJQUFFLHVDQUFHLENBQUE7SUFBRSwyQ0FBSyxDQUFBO0lBQUUsNkNBQU0sQ0FBQTtJQUFFLDJDQUFLLENBQUE7SUFBRSw2Q0FBTSxDQUFBO0lBQUUsK0NBQU8sQ0FBQTtJQUFFLDZDQUFNLENBQUE7SUFBRSw2Q0FBTSxDQUFBO0lBQ3pFLDRDQUFLLENBQUE7SUFBRSw4Q0FBTSxDQUFBO0lBQUUsNENBQUssQ0FBQTtJQUFFLG9EQUFTLENBQUE7SUFBRSxnREFBTyxDQUFBO0FBQzFDLENBQUMsRUFIVyxpQkFBUyxLQUFULGlCQUFTLFFBR3BCO0FBSEQsSUFBWSxTQUFTLEdBQVQsaUJBR1gsQ0FBQTtBQUlELElBQUksWUFBWSxHQUE2QixFQUFFLENBQUM7QUFDaEQsWUFBWSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsR0FBRywwQkFBMEIsQ0FBQztBQUMzRCxZQUFZLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxHQUFHLDRCQUE0QixDQUFDO0FBQzlELFlBQVksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLEdBQUcscUJBQXFCLENBQUM7QUFDcEQsWUFBWSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsR0FBRyxzQkFBc0IsQ0FBQztBQUN2RCxZQUFZLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxHQUFHLG9CQUFvQixDQUFDO0FBQ3RELFlBQVksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsMEJBQTBCLENBQUM7QUFDM0QsWUFBWSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxjQUFjLENBQUM7QUFDaEQsWUFBWSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsR0FBRywwQkFBMEIs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LFNBQVMsQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2pELENBQUM7SUFFYSxjQUFLLEdBQW5CLFVBQW9CLElBQVk7UUFDOUIsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRWEsa0JBQVMsR0FBdkIsVUFBd0IsSUFBWTtRQUNsQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ25ELENBQUM7SUFDSCxlQUFDO0FBQUQsQ0FBQyxBQXhHRCxDQUE4QixLQUFLLEdBd0dsQztBQXhHWSxnQkFBUSxXQXdHcEIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBTdGFuZGFyZCBsaWJjIGVycm9yIGNvZGVzLiBBZGQgbW9yZSB0byB0aGlzIGVudW0gYW5kIEVycm9yU3RyaW5ncyBhcyB0aGV5IGFyZVxyXG4gKiBuZWVkZWQuXHJcbiAqIEB1cmwgaHR0cDovL3d3dy5nbnUub3JnL3NvZnR3YXJlL2xpYmMvbWFudWFsL2h0bWxfbm9kZS9FcnJvci1Db2Rlcy5odG1sXHJcbiAqL1xyXG5leHBvcnQgZW51bSBFcnJvckNvZGUge1xyXG4gIEVQRVJNLCBFTk9FTlQsIEVJTywgRUJBREYsIEVBQ0NFUywgRUJVU1ksIEVFWElTVCwgRU5PVERJUiwgRUlTRElSLCBFSU5WQUwsXHJcbiAgRUZCSUcsIEVOT1NQQywgRVJPRlMsIEVOT1RFTVBUWSwgRU5PVFNVUFxyXG59XHJcbi8qKlxyXG4gKiBTdHJpbmdzIGFzc29jaWF0ZWQgd2l0aCBlYWNoIGVycm9yIGNvZGUuXHJcbiAqL1xyXG52YXIgRXJyb3JTdHJpbmdzOiB7W2NvZGU6IHN0cmluZ106IHN0cmluZ30gPSB7fTtcclxuRXJyb3JTdHJpbmdzW0Vycm9yQ29kZS5FUEVSTV0gPSAnT3BlcmF0aW9uIG5vdCBwZXJtaXR0ZWQuJztcclxuRXJyb3JTdHJpbmdzW0Vycm9yQ29kZS5FTk9FTlRdID0gJ05vIHN1Y2ggZmlsZSBvciBkaXJlY3RvcnkuJztcclxuRXJyb3JTdHJpbmdzW0Vycm9yQ29kZS5FSU9dID0gJ0lucHV0L291dHB1dCBlcnJvci4nO1xyXG5FcnJvclN0cmluZ3NbRXJyb3JDb2RlLkVCQURGXSA9ICdCYWQgZmlsZSBkZXNjcmlwdG9yLic7XHJcbkVycm9yU3RyaW5nc1tFcnJvckNvZGUuRUFDQ0VTXSA9ICdQZXJtaXNzaW9uIGRlbmllZC4nO1xyXG5FcnJvclN0cmluZ3NbRXJyb3JDb2RlLkVCVVNZXSA9ICdSZXNvdXJjZSBidXN5IG9yIGxvY2tlZC4nO1xyXG5FcnJvclN0cmluZ3NbRXJyb3JDb2RlLkVFWElTVF0gPSAnRmlsZSBleGlzdHMuJztcclxuRXJyb3JTdHJpbmdzW0Vycm9yQ29kZS5FTk9URElSXSA9ICdGaWxlIGlzIG5vdCBhIGRpcmVjdG9yeS4nO1xyXG5FcnJvclN0cmluZ3NbRXJyb3JDb2RlLkVJU0RJUl0gPSAnRmlsZSBpcyBhIGRpcmVjdG9yeS4nO1xyXG5FcnJvclN0cmluZ3NbRXJyb3JDb2RlLkVJTlZBTF0gPSAnSW52YWxpZCBhcmd1bWVudC4nO1xyXG5FcnJvclN0cmluZ3NbRXJyb3JDb2RlLkVGQklHXSA9ICdGaWxlIGlzIHRvbyBiaWcuJztcclxuRXJyb3JTdHJpbmdzW0Vycm9yQ29kZS5FTk9TUENdID0gJ05vIHNwYWNlIGxlZnQgb24gZGlzay4nO1xyXG5FcnJvclN0cmluZ3NbRXJyb3JDb2RlLkVST0ZTXSA9ICdDYW5ub3QgbW9kaWZ5IGEgcmVhZC1vbmx5IGZpbGUgc3lzdGVtLic7XHJcbkVycm9yU3RyaW5nc1tFcnJvckNvZGUuRU5PVEVNUFRZXSA9ICdEaXJlY3RvcnkgaXMgbm90IGVtcHR5Lic7XHJcbkVycm9yU3RyaW5nc1tFcnJvckNvZGUuRU5PVFNVUF0gPSAnT3BlcmF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQuJztcclxuXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgQnJvd3NlckZTIGVycm9yLiBQYXNzZWQgYmFjayB0byBhcHBsaWNhdGlvbnMgYWZ0ZXIgYSBmYWlsZWRcclxuICogY2FsbCB0byB0aGUgQnJvd3NlckZTIEFQSS5cclxuICogZXJybm8/OiBudW1iZXI7XHJcbiAgICAgICAgY29kZT86IHN0cmluZztcclxuICAgICAgICBwYXRoPzogc3RyaW5nO1xyXG4gICAgICAgIHN5c2NhbGw/OiBzdHJpbmc7XHJcbiAgICAgICAgc3RhY2s/OiBzdHJpbmc7XHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQXBpRXJyb3IgZXh0ZW5kcyBFcnJvciBpbXBsZW1lbnRzIE5vZGVKUy5FcnJub0V4Y2VwdGlvbiB7XHJcbiAgcHVibGljIGVycm5vOiBFcnJvckNvZGU7XHJcbiAgcHVibGljIGNvZGU6IHN0cmluZztcclxuICBwdWJsaWMgcGF0aDogc3RyaW5nO1xyXG4gIC8vIFVuc3VwcG9ydGVkLlxyXG4gIHB1YmxpYyBzeXNjYWxsOiBzdHJpbmcgPSBcIlwiO1xyXG4gIHB1YmxpYyBzdGFjazogc3RyaW5nO1xyXG5cclxuICAvKipcclxuICAgKiBSZXByZXNlbnRzIGEgQnJvd3NlckZTIGVycm9yLiBQYXNzZWQgYmFjayB0byBhcHBsaWNhdGlvbnMgYWZ0ZXIgYSBmYWlsZWRcclxuICAgKiBjYWxsIHRvIHRoZSBCcm93c2VyRlMgQVBJLlxyXG4gICAqXHJcbiAgICogRXJyb3IgY29kZXMgbWlycm9yIHRob3NlIHJldHVybmVkIGJ5IHJlZ3VsYXIgVW5peCBmaWxlIG9wZXJhdGlvbnMsIHdoaWNoIGlzXHJcbiAgICogd2hhdCBOb2RlIHJldHVybnMuXHJcbiAgICogQGNvbnN0cnVjdG9yIEFwaUVycm9yXHJcbiAgICogQHBhcmFtIHR5cGUgVGhlIHR5cGUgb2YgdGhlIGVycm9yLlxyXG4gICAqIEBwYXJhbSBbbWVzc2FnZV0gQSBkZXNjcmlwdGl2ZSBlcnJvciBtZXNzYWdlLlxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHR5cGU6IEVycm9yQ29kZSwgbWVzc2FnZTogc3RyaW5nID0gRXJyb3JTdHJpbmdzW3R5cGVdLCBwYXRoOiBzdHJpbmcgPSBudWxsKSB7XHJcbiAgICBzdXBlcihtZXNzYWdlKTtcclxuICAgIHRoaXMuZXJybm8gPSB0eXBlO1xyXG4gICAgdGhpcy5jb2RlID0gRXJyb3JDb2RlW3R5cGVdO1xyXG4gICAgdGhpcy5wYXRoID0gcGF0aDtcclxuICAgIHRoaXMuc3RhY2sgPSAoPGFueT5uZXcgRXJyb3IoKSkuc3RhY2s7XHJcbiAgICB0aGlzLm1lc3NhZ2UgPSBgRXJyb3I6ICR7dGhpcy5jb2RlfTogJHttZXNzYWdlfSR7dGhpcy5wYXRoID8gYCwgJyR7dGhpcy5wYXRofSdgIDogJyd9YDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEByZXR1cm4gQSBmcmllbmRseSBlcnJvciBtZXNzYWdlLlxyXG4gICAqL1xyXG4gIHB1YmxpYyB0b1N0cmluZygpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMubWVzc2FnZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyB0b0pTT04oKTogYW55IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGVycm5vOiB0aGlzLmVycm5vLFxyXG4gICAgICBjb2RlOiB0aGlzLmNvZGUsXHJcbiAgICAgIHBhdGg6IHRoaXMucGF0aCxcclxuICAgICAgc3RhY2s6IHRoaXMuc3RhY2ssXHJcbiAgICAgIG1lc3NhZ2U6IHRoaXMubWVzc2FnZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgZnJvbUpTT04oanNvbjogYW55KTogQXBpRXJyb3Ige1xyXG4gICAgdmFyIGVyciA9IG5ldyBBcGlFcnJvcigwKTtcclxuICAgIGVyci5lcnJubyA9IGpzb24uZXJybm87XHJcbiAgICBlcnIuY29kZSA9IGpzb24uY29kZTtcclxuICAgIGVyci5wYXRoID0ganNvbi5wYXRoO1xyXG4gICAgZXJyLnN0YWNrID0ganNvbi5zdGFjaztcclxuICAgIGVyci5tZXNzYWdlID0ganNvbi5tZXNzYWdlO1xyXG4gICAgcmV0dXJuIGVycjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFdyaXRlcyB0aGUgQVBJIGVycm9yIGludG8gYSBidWZmZXIuXHJcbiAgICovXHJcbiAgcHVibGljIHdyaXRlVG9CdWZmZXIoYnVmZmVyOiBCdWZmZXIgPSBuZXcgQnVmZmVyKHRoaXMuYnVmZmVyU2l6ZSgpKSwgaTogbnVtYmVyID0gMCk6IEJ1ZmZlciB7XHJcbiAgICB2YXIgYnl0ZXNXcml0dGVuID0gYnVmZmVyLndyaXRlKEpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKCkpLCBpICsgNCk7XHJcbiAgICBidWZmZXIud3JpdGVVSW50MzJMRShieXRlc1dyaXR0ZW4sIGkpO1xyXG4gICAgcmV0dXJuIGJ1ZmZlcjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZXMgYW4gQXBpRXJyb3Igb2JqZWN0IGZyb20gYSBidWZmZXIuXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBmcm9tQnVmZmVyKGJ1ZmZlcjogQnVmZmVyLCBpOiBudW1iZXIgPSAwKTogQXBpRXJyb3Ige1xyXG4gICAgcmV0dXJuIEFwaUVycm9yLmZyb21KU09OKEpTT04ucGFyc2UoYnVmZmVyLnRvU3RyaW5nKCd1dGY4JywgaSArIDQsIGkgKyA0ICsgYnVmZmVyLnJlYWRVSW50MzJMRShpKSkpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoZSBzaXplIG9mIHRoZSBBUEkgZXJyb3IgaW4gYnVmZmVyLWZvcm0gaW4gYnl0ZXMuXHJcbiAgICovXHJcbiAgcHVibGljIGJ1ZmZlclNpemUoKTogbnVtYmVyIHtcclxuICAgIC8vIDQgYnl0ZXMgZm9yIHN0cmluZyBsZW5ndGguXHJcbiAgICByZXR1cm4gNCArIEJ1ZmZlci5ieXRlTGVuZ3RoKEpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKCkpKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgRmlsZUVycm9yKGNvZGU6IEVycm9yQ29kZSwgcDogc3RyaW5nKTogQXBpRXJyb3Ige1xyXG4gICAgcmV0dXJuIG5ldyBBcGlFcnJvcihjb2RlLCBFcnJvclN0cmluZ3NbY29kZV0sIHApO1xyXG4gIH1cclxuICBwdWJsaWMgc3RhdGljIEVOT0VOVChwYXRoOiBzdHJpbmcpOiBBcGlFcnJvciB7XHJcbiAgICByZXR1cm4gdGhpcy5GaWxlRXJyb3IoRXJyb3JDb2RlLkVOT0VOVCwgcGF0aCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIEVFWElTVChwYXRoOiBzdHJpbmcpOiBBcGlFcnJvciB7XHJcbiAgICByZXR1cm4gdGhpcy5GaWxlRXJyb3IoRXJyb3JDb2RlLkVFWElTVCwgcGF0aCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIEVJU0RJUihwYXRoOiBzdHJpbmcpOiBBcGlFcnJvciB7XHJcbiAgICByZXR1cm4gdGhpcy5GaWxlRXJyb3IoRXJyb3JDb2RlLkVJU0RJUiwgcGF0aCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIEVOT1RESVIocGF0aDogc3RyaW5nKTogQXBpRXJyb3Ige1xyXG4gICAgcmV0dXJuIHRoaXMuRmlsZUVycm9yKEVycm9yQ29kZS5FTk9URElSLCBwYXRoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgRVBFUk0ocGF0aDogc3RyaW5nKTogQXBpRXJyb3Ige1xyXG4gICAgcmV0dXJuIHRoaXMuRmlsZUVycm9yKEVycm9yQ29kZS5FUEVSTSwgcGF0aCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIEVOT1RFTVBUWShwYXRoOiBzdHJpbmcpOiBBcGlFcnJvciB7XHJcbiAgICByZXR1cm4gdGhpcy5GaWxlRXJyb3IoRXJyb3JDb2RlLkVOT1RFTVBUWSwgcGF0aCk7XHJcbiAgfVxyXG59XHJcbiJdfQ==